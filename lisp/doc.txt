使用习惯之后也希望能够将本职工作迁移进来，并不喜欢 lsp-mode 和 lsp-java，依赖太多。

最近终于用上了 dape，Java 的 dape 设置需要在 jdtls 中设置。因此分享的是 eglot 的配置。
(defun jdtls-command-contact (&optional interactive)
  (let* ((jdtls-cache-dir (file-name-concat user-emacs-directory "cache" "lsp-cache"))
         (project-dir (file-name-nondirectory (directory-file-name (project-root (project-current)))))
         (data-dir (expand-file-name (file-name-concat jdtls-cache-dir (md5 project-dir))))
         ;; lombok 版本不能过低，会导致 dape 启动 lombok 不能加载。
         (jvm-args `(,(concat "-javaagent:" (expand-file-name "~/.m2/repository/org/projectlombok/lombok/1.18.34/lombok-1.18.34.jar"))
                     "-Xmx8G"
                     ;; "-XX:+UseG1GC"
                     "-XX:+UseZGC"
                     "-XX:+UseStringDeduplication"
                     ;; "-XX:FreqInlineSize=325"
                     ;; "-XX:MaxInlineLevel=9"
                     "-XX:+UseCompressedOops"))
         (jvm-args (mapcar (lambda (arg) (concat "--jvm-arg=" arg)) jvm-args))
         ;; tell jdtls the data directory and jvm args
         (contact (append '("jdtls")
                          jvm-args
                          `("-data" ,data-dir)
                          `(:initializationOptions
                            (:bundles
                             [,(file-truename "~/.m2/repository/com/microsoft/java/com.microsoft.java.debug.plugin/0.53.0/com.microsoft.java.debug.plugin-0.53.0.jar")])))))
    contact))

(push '((java-mode java-ts-mode) . jdtls-command-contact) eglot-server-programs)



2025-10-21

Configuration Updates

  1. Enhanced Eglot Configuration (init-eglot.el:11-35)

  - Replaced the basic jdtls configuration with the advanced setup from doc.txt
  - Added Lombok support with the proper Java agent configuration
  - Configured optimized JVM settings:
    - 8GB heap (-Xmx8G)
    - ZGC garbage collector (-XX:+UseZGC)
    - String deduplication (-XX:+UseStringDeduplication)
    - Compressed oops (-XX:+UseCompressedOops)
  - Added Microsoft Java debug plugin bundle for DAPE support
  - Support for both java-mode and java-ts-mode

  2. DAPE Debug Configuration (init-dape.el)

  - Created comprehensive DAPE configuration for Java debugging
  - Added key bindings for debugging operations:
    - C-c C-d C-c: Continue execution
    - C-c C-d C-b: Toggle breakpoint
    - C-c C-d C-n: Next line
    - C-c C-d C-s: Step into
    - C-c C-d C-o: Step out
  - Auto-discovery of main classes in projects
  - Interactive debugging setup with dape-java-debug-run

  3. Java Utilities Configuration (init-java.el)

  - Dependency checking function to verify Lombok and debug plugin availability
  - Automatic project setup when opening Java files
  - Maven dependency guidance for missing components
  - Key bindings:
    - C-c C-j c: Check dependencies
    - C-c C-j s: Setup project
    - C-c C-j r: Run main class

  Key Features Added

  ✅ Enhanced LSP Support: Improved jdtls configuration with performance optimizations
  ✅ DAPE Debugging: Full debugging support with breakpoint management and step execution
  ✅ Lombok Integration: Proper lombok agent configuration for annotation processing
  ✅ Dependency Management: Automatic checking and guidance for required Maven dependencies
  ✅ Project Detection: Automatic setup for Maven/Gradle projects
  ✅ Performance Optimizations: JVM tuning for better performance

  The configuration now provides a complete Java development environment without the heavy dependencies of lsp-mode and lsp-java, as requested. The setup follows your
  preference for eglot with DAPE debugging support.
